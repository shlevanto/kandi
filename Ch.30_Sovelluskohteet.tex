\chapter{Sovelluskohteet\label{applications}}
Bayes-verkon rakenteen oppimisella voidaan ajatella olevan neljä eri sovelluskohdetta. 1) posterioritapahtuman ennustaminen, 2) prioritapahtumien ennustaminen kun posterioritapahtuma on tunnettu, 3) graafin tulkitseminen muuttujien välsiten yhteyksien ymmärtämiseksi ja 4) intervention kohdentaminen sopivaan kohtaan. On huomioitava, että intervention kohdentaminen on merkittävästi muita sovelluskohteita haastavampi, koska se edellyttää tietoa muuttujien välisten riippuvuussuhteiden kausaalisuudesta.

Bayes-verkoilla on sovelluksia monilla tieteenaloissa. Insinööritieteessä niitä voidaan käyttää vikadiagnostiikkaan ja luotettavuuden arviointiin \citep{zhang_brief_2019}, lääketietessä diagnostiikan apuna \citep{mittal_review_2011}, tietoverkoissa poikkeavien tapahtumien ja mahdollisten tunkteutujien tunnistamiseen \citep{kaur_review_2013} ja vakuutusalalla riskitekijöiden välisten vuorovaikutusten ymmärtämiseen \citep{ramsahai_connecting_2020}. <tähän voisi vähän avata Ramsahain ajatuksia> Tässä tutkielmassa erityisenä kiinnostuksen kohteena on Bayes-verkkojen soveltaminen työkyvyttömyysriskin ennustamiseen ja mallintamiseen.

\section{Työkyvyttömyysriskin mallintaminen ja ennustaminen}

Väestön vanhetessa työvoiman saatavuuden varmentistaminen ja työurien pidentäminen on noussut tärkeäksi tavoitteeksi työelämän kehittämisessä. Työkyvyttömyysriskin hallinta on toimintaa, jolla pyritään vähentämään työntekijöiden riskiä päätyä työkyvyttömäksi ja joutua työkyvyttömyysetuudelle. Ennenaikainen työkyvyttömyys ja työkyvyttömyyseläkkeet muodostavat ison kuluerän niin työeläkejärjestelmälle, kuin koko yhteiskunnalle. Suomessa työkyvyttömyysriskin hallinnasta vastaavat osaltaan työeläkeyhtiö.

Työeläkeyhtiölle kertyvä data sisältää vakuutettujen työntekijöiden henkilötiedon lisäksi tietoa hänen työhistoriastaan ja ansioistaan. Lisäksi työkyvyttömyysetuuksiin (työkyvyttömyyseläke tai ammatillinen kuntoutus) liittyvien hakemusten myötä kertyy tietoa työkyvyttömyyden taustalla olevasta sairaudesta tai vammasta. Tämän datan perusteella voidaan arvioida minkälaiset riskitekijät ennustavat työkyvyttömyysetuudelle joutumista. On myös mahdollista laskea riski sille, että henkilö hakee etuutta tai tarkastella todennäköisyyttä, jolla haettu etuus myönnetään. Työkyvyttömyysriski ja työkyvyttömyysetuuden hakualttiutta on arvioitu suomalaisissa alan tutkimuksissa. \citet{karolaakso_contextual_2021, karolaakso_socioeconomic_2020} ovat osoittaneet, että mielenterveysperustesia työkyvyttömyyseeläkkeitä selittävät asuinalueeseen liittyvä sosioekonominen tieto. \citet{perhoniemi_determinants_2020, perhoniemi_tyokyvyttomyyselakehakemusten_2020} ovat osoittaneet, että sosioekonominen asema ja aiempi työttömyyshistoria on yhteydessä siihen, myönnetäänkö hakijalle työkyvyttömyyseläke kun hän sitä hakee. Tämä yhteys selittyy osittain sillä, että matalamassa sosioekonomisessa asemassa olevat hakevat suhteellisesti useammin työkyvyttömyyseläkettä, kuin korkeammassa sosioekonomisessa asemassa olevat.

\citet{gross_machine_2020} esittelevät esipuheessaan lehden teemanumeron, joka käsittelee koneoppimisen soveltamista työkyvyttömyysriskiin. Heidän mukaansa yökyvyttömyysriskin ennustamisessa on perinteisesti luotettu tilastollisiin menetelmiin, etenkin regressioanalyysiin ja koneoppimisen sovelluksissa ollaan vielä varsin alkutekijöissä. En ole löytänyt kuvausta siitä, että Bayes-verkkojen hyödyntämistä olisi tutkittu työkyvyttömyysriskin mallintamisessa. 

 Suomessa Eläketurvakeskus on julkaissut alustavia tietoja omista kokeiluistaan koneoppimismenetelmistä työkyvyttömyysriskin ennustamisessa. \citet{varis_aketurvakeskuksen_2018} kuvailee alustavia tuloksia neljällä eri luokittelumenetelmällä (regressio, päätöspuu, gradient boosting ja neuroverkko), ja toteaa, että parhaiten ennustavat muuttujat noudattavat aiempaa tutkimustietoa: sosioekonomiset tekijät, henkilön ansiohistoria ja aiemmat etuudet ennustavat hyvin erityisesti korkeaa työkvyttömyyden riskiä.  \citet{saarela_work_2022} vertailivat työkyvyttömyysriskin tunnistamiseen kahta lähestymistapaa. Ensimmäisessä $M_{pension}$ mallissa tutkittiin \citet{varis_aketurvakeskuksen_2018} tuloksia ja toisessa $M_{health}$ mallissa \citet{huhta-koivisto_work_2020} diplomityössään esittelemää luonnollisen kielen tunnistamista työterveyden potilastietoihin soveltavaa mallia. \citet{varis_aketurvakeskuksen_2018} mukaan molempien mallien ennustekyky oli varsin hyvä, eläkerekisteridataaa käyttävä $M_{pension}$ osumatarkkuus oli parempi. Toki tässä kannattaa huomioida, että henkilön jättäessä työkyvyttömyysetuushakemuksen on hänen terveydentilansa ja työkykynsä jo selkeästi alentunut eli työkyvyttömyyden riski on suurempi kuin sellaisella, joka ei ole etuutta hakenut. Graafisia malleja soveltaneet \citet{airaksinen_development_2017} kehittivät suomalaisella aineistolla työkyvyttömyyden yksilöriskin ennustemallin kahdeksalle muuttujalle. He käyttivät mallin rakentamisessa BIC:lle sukua olevaa \emph{AIC}-pisteytystä (\texttt{Akaike Information Criterion}) ja lisäksi tutkivat käytettyjen muuttujien kahdenvälisiä riippuvuussuhteita. AIC:n ja BIC:n yhtäläisyyksiä ja eroja ovat vertailleet esim. \citet{ding_model_2018}.

Omalla työpaikallani olemme kokeilleet \citet{friedman_greedy_2001} esittelemiä \emph{gradient boosting} -menetelmällä tehostettuja päätöksentekopuita. Olemme lisäksi tarkastelleet malleihin mukaan otettujen muuttujien vaikutusta ennusteeseen peliteoriasta lähtöisin olevien \emph{Shapley-arvojen} avulla. Shapley-arvojen tarkempi käsittely rajautuu tämän tutkielman ulkopuolelle, mutta niiden käyttämisestä koneoppimismallien arvioimiseen löytyy lisää tietoa esim. \citet{merrick_explanation_2020}. Shapley-arvot eivät suoraan anna tulkintamahdollisuutta muuttujien välisistä riippuvuuksista, ja olemme analysoineet näitä toistaiseksi vain silmämääräisesti parittaisissa vertailuissa.

Kaikille tässä kuvailemilleni koneoppimisen sovelluksille työkyvyttömyysriskin ennustamisessa on yhteistä se, ettei muuttujien yhteisvaikutuksia tai riippuvuuksia ole tarkasteltu muutoin kuin korkeintaan parittain vertailemalla. Bayes-verkon rakenteen oppiminen tarjoaa menetelmänä erinomaisen mahdollisuuden hahmottaa näitä mahdollisia riippuvuuksia, kun meillä on jo tiedossa muuttujajoukko, jonka tiedämme toimivan hyvin työkyvyttömyysriskin ennustamiseen. Hieman samantyyppistä lähestymistapaa ovat käyttäneet \citet{elovainio_is_2021, elovainio_network_2020} tutkimuksissaan masennuksen taustatekijöistä ja niiden keskinäisistä yhteyksistä.

%%Mikä sitten olisi Bayes-verkon sovelluskohde?

%%1) graafin tulkinta
%%2) ennuste
%%3) tiedetään että jää eläkkeelle -> voidaan ennustaa taustamuuttuja (ammatillinen kuntoutus voisi olla mielenkiintoinen -> onko jokin demografinen ryhmä, jolle alitarjotaan kuntoutusta)
%%4) interventiot: jos olisi kausaalinen verkko, voitaisiin löytää kohta jota olisi pitänyt muuttaa --> ammatillinen kuntoutus? -> kenelle pitäisi tarjota enemmän, kenellä jää käyttämättä koik?
